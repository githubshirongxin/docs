---
layout: post
title: 动态申请Lab资源
---

## 20201230提出问题：
![](/docs/images/lab申请资源20201230.jpg)

## 2021-04-27 playground的修改建议
![](/docs/images/playground-20210427.jpg)

### 1. 增加资源使用期限
- 应用的后台维护资源-》使用时间表。
- 教育admin后端新启动一个服务，到时间，向k8s端的接口发送destory请求。
- k8s清理资源，应用清理表格。

### 2， 增加每个人使用资源数的限制。
- 应用后端维护用户-》资源列表。

### 3，增加每个资源的资源限制，暂定内存1G，硬盘1G
- 应用前端设置可选项1G以内。
- ~~k8s应用主动定期发送每个资源的占用情况给应用后端接口。~~   (2021-05-10 by team)
- admin应用发送k8s的时候返回报文中就记录了该服务器的资源占用情况，然后保存到DB。 (2021-05-10 by team)
- k8s端修改返回的报文增加服务器占用资源信息。  (2021-05-10 by team)
- 应用后端接口，更新DB，维护资源-占用状况。
- 在playground的服务器一览上显示资源占用状况。

### 4，应用前端显示，每个pod单独作为一个服务器显示。
- 单独显示服务器，例如，一次申请三个服务器，显示三行。而不是一行。
- 服务器申请时加上服务器memo。防止自己忘记该服务器使用目的。
- 增加资源占用显示。了解自己的服务器使用状况
- 增加剩余时间，了解自己服务器使用状况。
- 显示该用户占用的全部资源。 


### 5， k8s生产环境
- k8s所有资源监控页面必须增加密码。现在是有端口就能访问。
- k8s端分配资源所用到的shell也需要发布到k8s上。避免master死掉之后，无法分配资源。
- 定操作员和操作流程。
- 新node加入时候，逻辑安装手顺。加入k8s手顺。 （done）

### 6，应用后台增加统计
#### 各种排序：
- 谁，使用了什么，按mem排序，按disk排序，按cpu排序
- 使用最多资源的人排序。
- 哪个服务器，按mem排序，按disk排序，按cpu排序
#### 统计
- 所有人，总共使用了多少mem，disk，cpu

