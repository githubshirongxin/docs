---
layout: post
title: linux内核源代码情景分析001
---

# 1. 预备知识
## 1.1 linux内核简介
Intel80386，i386CPU
内核源代码/usr/src/linux/ 源代码组成

里面各种cpu，各种网卡的目录，但是编译后值针对特定cpu特定网卡。
x.yy.zzpNN , x大版本。yy中版本，zz微小改进。NN bug修正
yy偶数：发行版。yy奇数：开发版本。

各个linux发行商的版本必须包括linux内核的版本。linux内核只有一个（版本多个）。
RedHat6.0的内核版本是2.2.25.
linux发行商的版本，集成了大量工具和应用软件。
linux内核推出新的版本，发行商也就跟着推出一个版本。

GNU软件。GPL版权。FSF基金。
GPL全人类版权
GNU（Linux内核设计及实现）就是linux

## 1.2 intel x86 cpu寻址方式
i386即x86：8086，8088,80186,80286,80386,80486,Pentium芯片一系列16位微处理器。
16位cpu，1M内存（20位）。将16位地址映射到24位地址空间。
cpu中有四个段寄存器：CS、DS、SS、ES。都是16位的，对应地址总线的高16位。送到地址总线之前都在cpu中计算出20位的实际地址。
80286保护模式

剩下的没看下去


## 1.3 i386的页式内存管理机制
看下去了，大概了解了

## 1.4 linux内核源代码中的C语言代码
- 内核只能用gcc编译，gcc与内核版本平行增长
融合了c和c++
扩展了ANSI C（多了保留字）
inline函数的使用相当于一部分代码从.c移入.h，提高了运行效率。

## 1.5 linux内核源代码中的汇编
3万行代码（内核2.3.28）仅仅20个文件是汇编.s或.m，加起来不到2000行。主要是关于中断和异常处理。
两种情况，
- 纯汇编（.s 经过预编译生成真正的汇编）
- 嵌入到c中的汇编（语法介于汇编和c之间，不容易懂）
### 1.5.1 GNU的386汇编语言
unix采用的AT&T格式的386汇编格式，dos/win采用了intel格式。
两个格式不同。
差别：
- AT&T多用小写
- AT&T寄存器前加%
- AT&T指定源和目标的顺序与intel正好相反。
- AT&T操作数的宽度由最后一个字母决定b：8位，w：16位，l：32位。
