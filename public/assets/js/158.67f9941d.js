(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{644:function(s,a,t){"use strict";t.r(a);var e=t(59),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"参考：【搭建基于nginx的rtmp直播服务器】"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考：【搭建基于nginx的rtmp直播服务器】"}},[s._v("#")]),s._v(" 参考："),t("a",{attrs:{href:"https://hywlovexyc.info/blog/archives/572/#%E6%8E%A8%E6%8B%89%E6%B5%81",target:"_blank",rel:"noopener noreferrer"}},[s._v("【搭建基于nginx的rtmp直播服务器】"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"https://hywlovexyc.info/blog/category/Tech/",target:"_blank",rel:"noopener noreferrer"}},[s._v("技术"),t("OutboundLink")],1),s._v(","),t("a",{attrs:{href:"https://hywlovexyc.info/blog/category/video/",target:"_blank",rel:"noopener noreferrer"}},[s._v("视频"),t("OutboundLink")],1)]),s._v(" "),t("h1",{attrs:{id:"搭建基于nginx的rtmp直播服务器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#搭建基于nginx的rtmp直播服务器"}},[s._v("#")]),s._v(" 搭建基于nginx的rtmp直播服务器")]),s._v(" "),t("p",[s._v("发表于 2019-12-12 浏览量 3490")]),s._v(" "),t("h1",{attrs:{id:"视频教程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#视频教程"}},[s._v("#")]),s._v(" 视频教程")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.bilibili.com/video/av78957794",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.bilibili.com/video/av78957794"),t("OutboundLink")],1),t("br"),s._v("\nOBS录屏推流教程："),t("a",{attrs:{href:"https://www.bilibili.com/video/av78808759",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.bilibili.com/video/av78808759"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("搭建nginx + nginx-rtmp-module"),t("br"),s._v("\n演示的系统使用CentOS-7-x86_64-Everything-1611.iso")]),s._v(" "),t("h2",{attrs:{id:"关闭防火墙"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#关闭防火墙"}},[s._v("#")]),s._v(" 关闭防火墙")]),s._v(" "),t("p",[s._v("请根据实际情况调整防火墙。为了演示方便，博主关闭防火墙。"),t("br"),s._v("\n临时停止")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("systemctl stop firewalld\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("禁用")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("systemctl disable firewalld\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("查看状态")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("systemctl status firewalld\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"安装wget"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装wget"}},[s._v("#")]),s._v(" 安装wget")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("yum -y install wget\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"安装-gcc-gcc-c"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装-gcc-gcc-c"}},[s._v("#")]),s._v(" 安装 gcc gcc-c++")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("yum -y install gcc gcc-c++\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"安装pcre库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装pcre库"}},[s._v("#")]),s._v(" 安装PCRE库")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /usr/local/\nwget http://jaist.dl.sourceforge.net/project/pcre/pcre/8.33/pcre-8.33.tar.gz\ntar -zxvf pcre-8.33.tar.gz\ncd pcre-8.33\n./configure\nmake && make install\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"安装openssl"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装openssl"}},[s._v("#")]),s._v(" 安装openssl")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /usr/local/ \nwget http://www.openssl.org/source/openssl-1.0.1j.tar.gz \ntar -zxvf openssl-1.0.1j.tar.gz \ncd openssl-1.0.1j\n./config\nmake && make install\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://pic.hywlovexyc.info/images/2019/12/12/nginxrtmp2.jpg",alt:"nginxrtmp2.jpg",title:"nginxrtmp2.jpg"}}),t("br"),s._v("\n如果提示You need Perl 5，则输入下面这个命令。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("yum -y install Perl 5\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"安装zlib"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装zlib"}},[s._v("#")]),s._v(" 安装zlib")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /usr/local/\nwget http://zlib.net/zlib-1.2.11.tar.gz\ntar -zxvf zlib-1.2.11.tar.gz\ncd ./zlib-1.2.11\n./configure\nmake && make install\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"git-clone"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#git-clone"}},[s._v("#")]),s._v(" git clone")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /usr/local/\nyum -y install git\ngit clone https://github.com/arut/nginx-rtmp-module.git \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"安装nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nginx"}},[s._v("#")]),s._v(" 安装nginx")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cd /usr/local/\nwget http://nginx.org/download/nginx-1.8.0.tar.gz\ntar -zxvf nginx-1.8.0.tar.gz\ncd nginx-1.8.0\n./configure --prefix=/usr/local/src/nginx --with-http_stub_status_module --with-http_gzip_static_module --with-http_realip_module --with-http_sub_module --with-http_ssl_module  --add-module=../nginx-rtmp-module  --with-openssl=/usr/local/openssl-1.0.1j --with-http_ssl_module\nmake && make install \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[s._v("疑问：")]),s._v(" "),t("p",[s._v("--prefix=/usr/local/src/nginx 这时什么意思？实际nginx下载目录是/usr/local/nginx-1.8.0\n为什么不指定这个目录呢？")])]),s._v(" "),t("p",[s._v("如果提示")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("./configure: error: SSL modules require the OpenSSL library.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("执行")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("yum -y install openssl openssl-devel\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("如果提示")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(" ./configure: error: the HTTP rewrite module requires the PCRE library.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("执行")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("yum -y install pcre-devel\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("我下载并安装了pcre-8.33.tar.gz 和 openssl-1.0.1j.tar.gz ，并没有出现上面的错误")]),s._v(" "),t("h1",{attrs:{id:"nginx相关命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx相关命令"}},[s._v("#")]),s._v(" nginx相关命令")]),s._v(" "),t("p",[s._v("启动")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("/usr/local/src/nginx/sbin/nginx\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("重启")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("/usr/local/src/nginx/sbin/nginx –s reload\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("启动后，打开浏览器，输入服务器ip地址，访问显示如下页面，则表示成功安装。"),t("br"),s._v(" "),t("img",{attrs:{src:"https://pic.hywlovexyc.info/images/2019/12/12/nginxrtmp3.jpg",alt:"nginxrtmp3.jpg",title:"nginxrtmp3.jpg"}})]),s._v(" "),t("h1",{attrs:{id:"修改conf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改conf"}},[s._v("#")]),s._v(" 修改conf")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pic.hywlovexyc.info/images/2019/12/12/nginxrtmp4.jpg",alt:"nginxrtmp4.jpg",title:"nginxrtmp4.jpg"}}),t("br"),s._v("\n使用winscp前往/usr/local/src/nginx/conf/nginx.conf"),t("br"),s._v("\n在http{前加入")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("rtmp {\n    server {\n        listen 1935; #监听的端口\n        chunk_size 4000;\n        # rtmp://ip:1935/yuchen/推流密钥 ，推流密钥在推流时指定。\n        application yuchen {#rtmp推流请求路径 (切记路径错了会推不上流)\n            live on; #开启实时\n            hls on; #开启hls\n            hls_path /usr/local/src/nginx/html/yuchen; #rtmp推流请求路径，文件存放路径\n            hls_fragment 5s; #每个TS文件包含5秒的视频内容\n        }\n    }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[s._v("修改完成后，使用命令重启nginx")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("/usr/local/src/nginx/sbin/nginx –s reload\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"推流"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#推流"}},[s._v("#")]),s._v(" 推流")]),s._v(" "),t("p",[s._v("打开obs推流，右下角变为绿色方块则推流成功。\n"),t("img",{attrs:{src:"/docs/images/2020-09-03-10-52-59.png",alt:""}})]),s._v(" "),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[s._v("注意：")]),s._v(" "),t("ul",[t("li",[s._v("推流的時候沒有指定端口！拉流才需要指定端口！")]),s._v(" "),t("li",[s._v("yuchen是nginx.conf中的application名字！")])])]),s._v(" "),t("p",[t("img",{attrs:{src:"/docs/images/2020-09-03-10-52-40.png",alt:""}})]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("WARNING")]),s._v(" "),t("ul",[t("li",[s._v("这个串流密码是随便写的，目的是让拉流的人也输入同样的密码才能看。")]),s._v(" "),t("li",[s._v("例如串流密码写shirx，那么拉流的人，必须写rtmp://ip:1935/yuchen/shirx")]),s._v(" "),t("li",[s._v("yuchen是nginx.conf里的application名字。")])])]),s._v(" "),t("h2",{attrs:{id:"拉流"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#拉流"}},[s._v("#")]),s._v(" 拉流")]),s._v(" "),t("p",[s._v("在potplayer中播放http的m3u8地址。或者是使用支持rtmp协议的播放器拉流。")]),s._v(" "),t("p",[s._v("使用VLC media player\n"),t("img",{attrs:{src:"/docs/images/2020-09-02-16-39-01.png",alt:""}}),s._v(" "),t("img",{attrs:{src:"/docs/images/2020-09-02-16-38-39.png",alt:""}}),s._v("\n就能看直播了。\n"),t("img",{attrs:{src:"/docs/images/2020-09-02-16-39-45.png",alt:""}})]),s._v(" "),t("p",[t("a",{attrs:{href:"https://hywlovexyc.info/blog/tag/%E6%9C%8D%E5%8A%A1%E5%99%A8/",target:"_blank",rel:"noopener noreferrer"}},[s._v("服务器"),t("OutboundLink")],1),t("br"),s._v(" "),t("a",{attrs:{href:"https://hywlovexyc.info/blog/tag/%E4%B8%B2%E6%B5%81/",target:"_blank",rel:"noopener noreferrer"}},[s._v("串流"),t("OutboundLink")],1),t("br"),s._v(" "),t("a",{attrs:{href:"https://hywlovexyc.info/blog/tag/nginx/",target:"_blank",rel:"noopener noreferrer"}},[s._v("nginx"),t("OutboundLink")],1),t("br"),s._v(" "),t("a",{attrs:{href:"https://hywlovexyc.info/blog/archives/570/",title:"内网穿透工具nps使用教程",target:"_blank",rel:"noopener noreferrer"}},[s._v("内网穿透工具nps使用教程"),t("OutboundLink")],1),t("br"),s._v(" "),t("a",{attrs:{href:"https://hywlovexyc.info/blog/archives/576/",title:"在VMware workstation/ESXi上安装群晖DSM6.2",target:"_blank",rel:"noopener noreferrer"}},[s._v("在VMware workstation/ESXi上安装群晖DSM6.2"),t("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);