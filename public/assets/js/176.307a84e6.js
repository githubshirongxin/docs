(window.webpackJsonp=window.webpackJsonp||[]).push([[176],{659:function(s,t,e){"use strict";e.r(t);var r=e(59),a=Object(r.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"搭建-typescript-正式工作环境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#搭建-typescript-正式工作环境"}},[s._v("#")]),s._v(" 搭建 TypeScript 正式工作环境")]),s._v(" "),e("p",[s._v("俗话说得好「工欲善其事,必先利其器」,我们在上一节已经搭建好了基础的 TypeScript 环境,并写下了第一行 TypeScript 代码,但是这并不足以支持大家日常的开发,在本节我们将搭建一个在生产环境可用的 TypeScript 环境,以此帮助大家了解 TypeScript 的工具生态.")]),s._v(" "),e("p",[s._v("除此之外,我们还会推荐一些 TypeScript 快速启动的库帮助大家免去搭建环境的烦恼,那么既然都已经有了相关的快速启动库了,为什么我们还要从头搭建环境呢?")]),s._v(" "),e("p",[s._v("原因在于所有的库都是搭建好的,定制性很差,我们如果真的想成为一名合格的 TypeScript 使用者必须要学会搭建环境,不然一方面我们没有任何搭建环境的能力,一旦有一些特殊要求,我们连拓展环境都做不到,另一方面,开发过程中很多错误或者警告其实不是代码本身有问题,而是环境出现了问题,如果我们不懂环境方面的问题,会浪费很多时间.")]),s._v(" "),e("h2",{attrs:{id:"生产环境要素"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#生产环境要素"}},[s._v("#")]),s._v(" 生产环境要素")]),s._v(" "),e("p",[s._v("在正式开始之前我们需要思考一下,一个正式的 TypeScript 开发环境至少需要哪些要素呢?")]),s._v(" "),e("ul",[e("li",[s._v("文本编辑器/IDE: 编写代码是任何开发环境的要素之一,本文会以 VS Code 为例来讲解如何配置我们的文本编辑器")]),s._v(" "),e("li",[s._v("单元测试: 除非是一般的临时服务,一个长期代码是必须要经过单元测试的,本文会以非常热门的 Jest 作为单测工具")]),s._v(" "),e("li",[s._v("代码检查: 从 JSLint 开始,代码检查就进入了前端开发者的视野中,由于 TSLint 被 TypeScript 官方抛弃,我们会以 ESlint 作为代码检查工具")])]),s._v(" "),e("p",[s._v("当然还有版本管理工具、持续集成工具、代码美化工具等等,但这些跟 TypeScript 相关性并不大,并非我们的重点.")]),s._v(" "),e("h2",{attrs:{id:"配置文本编辑器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置文本编辑器"}},[s._v("#")]),s._v(" 配置文本编辑器")]),s._v(" "),e("p",[s._v("如果你对VS Code感兴趣的话,可以去"),e("a",{attrs:{href:"https://code.visualstudio.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),e("OutboundLink")],1),s._v("进行下载.")]),s._v(" "),e("blockquote",[e("p",[s._v("注意: 在下载 VS Code 之前请确保已经安装最新版的 Node")])]),s._v(" "),e("h3",{attrs:{id:"安装插件-ts-importer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装插件-ts-importer"}},[s._v("#")]),s._v(" \b\b安装插件 TS Importer")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://marketplace.visualstudio.com/items?itemName=pmneo.tsimporter",target:"_blank",rel:"noopener noreferrer"}},[s._v("TS Importer"),e("OutboundLink")],1),s._v("是一个非常实用的 VS Code 插件,它的作用在于可以帮助开发者自动引入模块.")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/10/10/16db3fc83dd56c02?w=833&h=467&f=gif&s=915037",alt:""}})]),s._v(" "),e("p",[s._v("这个插件在编写依赖关系相对复杂的项目时非常有用,节省了我们手动引入模块的时间,而且最大程度规避了犯错的可能.")]),s._v(" "),e("p",[s._v("如果你想定制引入的格式,比如不想使用分号,你可以: 设置->搜索 "),e("code",[s._v("tsimporter")]),s._v(" ,进行编辑即可,你可以选择是否用分号,是否用双引号等等.")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/10/10/16db3fc83e6a4f03?w=570&h=537&f=png&s=57863",alt:"2019-10-07-13-10-29"}})]),s._v(" "),e("h3",{attrs:{id:"安装插件-move-ts"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装插件-move-ts"}},[s._v("#")]),s._v(" 安装插件 Move TS")]),s._v(" "),e("p",[s._v("在我们移动一个文件的时候会有一个问题,我们的文件位置发生变化,相对引入模块的路径也会发生变化,这个是如果引入的路径很多,那么要一个个去改吗?")]),s._v(" "),e("p",[s._v("这就要借助"),e("a",{attrs:{href:"https://marketplace.visualstudio.com/items?itemName=stringham.move-ts",target:"_blank",rel:"noopener noreferrer"}},[s._v("Move TS"),e("OutboundLink")],1),s._v("这个插件.")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/10/10/16db3fe2438a08dd?w=834&h=620&f=gif&s=1063274",alt:""}})]),s._v(" "),e("p",[s._v("它可以帮助开发者自动计算移动后的模块引入路径,是提升效率的利器.")]),s._v(" "),e("h3",{attrs:{id:"安装插件-typescript-toolbox"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装插件-typescript-toolbox"}},[s._v("#")]),s._v(" 安装插件 TypeScript Toolbox")]),s._v(" "),e("p",[s._v("顾名思义,这是 TypeScript 的一个工具箱,主要有两个作用: 自动引入模块和生成"),e("code",[s._v("getter/setter/Constructors")]),s._v(".")]),s._v(" "),e("p",[s._v("自动引入模块:")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/10/10/16db3fc83f5da706?w=830&h=260&f=gif&s=59875",alt:""}})]),s._v(" "),e("p",[s._v("生成getter/setter:")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/10/10/16db3fc83f8d797a?w=856&h=259&f=gif&s=59280",alt:""}})]),s._v(" "),e("h2",{attrs:{id:"为-typescript-添加测试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为-typescript-添加测试"}},[s._v("#")]),s._v(" 为 TypeScript 添加测试")]),s._v(" "),e("p",[s._v("Jest 是一款由 Facebook 开源的大而全的测试框架,它的特点是开箱即用,功能强大,目前三大框架全部采用 Jest 测试,它有如下优点:")]),s._v(" "),e("ul",[e("li",[s._v("强大的 TypeScript 支持")]),s._v(" "),e("li",[s._v("内置的断言库")]),s._v(" "),e("li",[s._v("快照测试")]),s._v(" "),e("li",[s._v("内置的覆盖率报告")]),s._v(" "),e("li",[s._v("内置的异步支持")])]),s._v(" "),e("p",[s._v("我们先下载下列 npm 模块:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("npm i jest @types/jest ts-jest -D\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("我们稍微解释一下:")]),s._v(" "),e("ul",[e("li",[s._v("jest: Jest 单元测试框架")]),s._v(" "),e("li",[s._v("@types/jest: Jest 是由 JavaScript 编写的(目前已经宣布之后会采用 TypeScript 开发),"),e("code",[s._v("@types/jest")]),s._v(" 是为 jest 添加类型声明的 npm 包")]),s._v(" "),e("li",[s._v("ts-jest: 本身是一个 TypeScript 预处理器,它可以帮助我们可以用 TypeScript 编写 jest 相关测试代码")])]),s._v(" "),e("p",[s._v("随后我们在项目的根目录创建文件"),e("code",[s._v("jest.config.js")]),s._v(":")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('module.exports = {\n  "roots": [\n    "<rootDir>/src"\n  ],\n  "transform": {\n    "^.+\\\\.tsx?$": "ts-jest"\n  },\n}\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("ul",[e("li",[s._v("roots: 让我们指定测试的根目录,通常情况下我们建议设置为 "),e("code",[s._v("src/")])]),s._v(" "),e("li",[s._v("transform: 这里我们使用 "),e("code",[s._v("ts-jest")]),s._v(" 来测试 "),e("code",[s._v("tsx/ts")]),s._v(" 文件")])]),s._v(" "),e("p",[s._v("接着我们在 "),e("code",[s._v("package.json")]),s._v(" 下修改如下:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('  "scripts": {\n    ...\n    "test": "jest",\n    "test:c": "jest --coverage",\n    "test:w": "jest --watchAll --coverage"\n  },\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("ul",[e("li",[s._v("jest: 是运行测试,jest 会寻找在 "),e("code",[s._v("src/")]),s._v(" 目录下所有符合要求的文件进行测试")]),s._v(" "),e("li",[s._v("jest --watchAll: 是以监控模式监控所有符合要求的文件")])]),s._v(" "),e("p",[s._v("我们开始写一段简单的代码进行测试 "),e("code",[s._v("src/foo.ts")]),s._v(":")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("export const sum = (a: number) => (b: number) => a + b;\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("然后新建一个 "),e("code",[s._v("__test__")]),s._v(" 目录存放测试文件,在 "),e("code",[s._v("foo.test.ts")]),s._v(" 下:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("import { sum } from '../foo';\n\ntest('basic', () => {\n  expect(sum(1)(2)).toBe(3);\n});\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("然后运行 "),e("code",[s._v("npm run test")]),s._v(":")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/10/10/16db3fc83fbe3c8d?w=485&h=205&f=png&s=24963",alt:"2019-10-07-14-17-43"}})]),s._v(" "),e("h2",{attrs:{id:"代码检查"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#代码检查"}},[s._v("#")]),s._v(" 代码检查")]),s._v(" "),e("p",[s._v("TSLint 长期以前是 TypeScript 主要的代码检测工具,但是由于一些性能问题 TypeScript 官方支持了 ESLint,随后 TSLint 作者宣布放弃 TSLint:")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/10/10/16db3fc8780a1553?w=1070&h=746&f=png&s=342099",alt:"2019-10-07-15-40-31"}})]),s._v(" "),e("p",[s._v("因此 ESLint 现在已经是事实上 TypeScript 的 Linter ,我们先下载以下模块:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("npm i eslint eslint-plugin-react @typescript-eslint/parser @typescript-eslint/eslint-plugin -D\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("以上各个模块说明如下: \b\b")]),s._v(" "),e("ul",[e("li",[s._v("eslint: 代码检查工具")]),s._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/yannickcr/eslint-plugin-react#list-of-supported-rules",target:"_blank",rel:"noopener noreferrer"}},[s._v("eslint-plugin-react"),e("OutboundLink")],1),s._v(": 使得eslint支持react框架")]),s._v(" "),e("li",[s._v("@typescript-eslint/parser: 让 eslint 可以解析 TypeScript")]),s._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/typescript-eslint/typescript-eslint/tree/master/packages/eslint-plugin#supported-rules",target:"_blank",rel:"noopener noreferrer"}},[s._v("@typescript-eslint/eslint-plugin"),e("OutboundLink")],1),s._v(": 使得 eslint 支持 TypeScript 相关规则")])]),s._v(" "),e("p",[s._v("在项目的根目录下创建 "),e("code",[s._v(".eslintrc.js")]),s._v(":")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("module.exports = {\n    parser: '@typescript-eslint/parser',\n    settings: {\n        react: {\n            version: 'detect'\n        }\n    },\n    parserOptions: {\n        project: './tsconfig.json',\n    },\n    plugins: ['@typescript-eslint'],\n    extends: [\n        'plugin:react/recommended',\n        'plugin:@typescript-eslint/recommended',\n    ],\n    rules: {\n        \"@typescript-eslint/explicit-function-return-type\": \"off\",\n    }\n}\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br")])]),e("p",[s._v("在 "),e("code",[s._v("package.json")]),s._v(" 添加如下:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('  "scripts": {\n    ...\n    "lint": "eslint \\"src/**\\"",\n    "lint:f": "eslint \\"src/**\\" --fix "\n  },\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("ul",[e("li",[e("code",[s._v("npm run lint")]),s._v(": 检测"),e("code",[s._v("src/")]),s._v("项目的代码")]),s._v(" "),e("li",[e("code",[s._v("npm run lint:f")]),s._v(": 检测"),e("code",[s._v("src/")]),s._v("项目的代码并自动修复")])]),s._v(" "),e("h2",{attrs:{id:"代码调试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#代码调试"}},[s._v("#")]),s._v(" 代码调试")]),s._v(" "),e("p",[s._v("用 VS Code 调试代码是很简单的事情,首先我们点击调式按钮:")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/10/10/16db3fc889e031f5?w=936&h=357&f=png&s=57392",alt:"2019-10-07-17-03-57"}})]),s._v(" "),e("p",[s._v("然后选择 node 环境:")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/10/10/16db3fc8aa902709?w=1019&h=300&f=png&s=49420",alt:"2019-10-07-17-05-22"}})]),s._v(" "),e("p",[s._v("配置调试环境:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{\n    "name": "node",\n    "type": "node",\n    "request": "launch",\n    "program": "${workspaceRoot}/dist/foo.js", //注意,这个路径必须是需要调试的文件`src/foo.ts`的编译后的路径即`/dist/foo.js`\n    "args": [],\n    "cwd": "${workspaceRoot}",\n    "protocol": "inspector"\n}\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("p",[s._v("我们就可以进行调试了:")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/10/10/16db3fc8b4a4fdeb?w=1191&h=687&f=png&s=199117",alt:"2019-10-07-17-01-23"}})]),s._v(" "),e("h2",{attrs:{id:"小结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),e("p",[s._v("我们现在已经搭建了一个可用的 TypeScript 开发环境,当然我们可以进一步完善它,但是这些内容与 TypeScript 本身的关系不大,如果你感兴趣的话,我们已经把完整的代码发布在了"),e("a",{attrs:{href:"https://github.com/xiaomuzhu/ts-start",target:"_blank",rel:"noopener noreferrer"}},[s._v("github"),e("OutboundLink")],1),s._v("上,你可以直接下载使用.")]),s._v(" "),e("p",[s._v("如果你想编写一个成熟的TypeScript库，那么可以使用以下两个 starter 之一：")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/alexjoverm/typescript-library-starter",target:"_blank",rel:"noopener noreferrer"}},[s._v("typescript-library-starter"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/bitjson/typescript-starter",target:"_blank",rel:"noopener noreferrer"}},[s._v("typescript-starter"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=a.exports}}]);