(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{556:function(e,r,t){"use strict";t.r(r);var i=t(59),o=Object(i.a)({},(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"_2020-09-18"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2020-09-18"}},[e._v("#")]),e._v(" 2020.09.18")]),e._v(" "),t("h2",{attrs:{id:"gitlab-ci配置感觉挺靠谱的样子"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gitlab-ci配置感觉挺靠谱的样子"}},[e._v("#")]),e._v(" gitlab-ci配置感觉挺靠谱的样子")]),e._v(" "),t("p",[e._v("https://www.cnblogs.com/cuishuai/p/9717794.html")]),e._v(" "),t("hr"),e._v(" "),t("h1",{attrs:{id:"_2020-09-17"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2020-09-17"}},[e._v("#")]),e._v(" 2020.09.17")]),e._v(" "),t("h2",{attrs:{id:"_1-gitlab-ci自动发布应用之-docker-in-docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-gitlab-ci自动发布应用之-docker-in-docker"}},[e._v("#")]),e._v(" 1. gitlab-ci自动发布应用之“docker in docker”")]),e._v(" "),t("p",[e._v("gitlab-ci.yml里如果把应用打包成镜像，需要使用docker build。\n要么runner里有docker，使用shell执行器。要么，gitlab-ci使用docker镜像，打包在改镜像里执行。\n这就引出一个"),t("code",[e._v("docker in docker")]),e._v("的问题。这个问题处理起来还挺多内容。\n"),t("strong",[e._v("要读的文章")])]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://stackoverflow.com/questions/61105333/cannot-connect-to-the-docker-daemon-at-tcp-localhost2375-is-the-docker-daem",target:"_blank",rel:"noopener noreferrer"}},[e._v("Cannot connect to the Docker daemon at tcp://localhost:2375/. Is the docker daemon running. On GitLab"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://gitlab.com/gitlab-org/gitlab-runner/-/issues/4501#note_195033385",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker in Docker 19.03 service fails"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_docker_build.html#use-docker-in-docker-executor",target:"_blank",rel:"noopener noreferrer"}},[e._v("Building Docker images with GitLab CI/CD"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_kaniko.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Building images with kaniko and GitLab CI/CD"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_docker_build.html#use-docker-in-docker-workflow-with-docker-executor",target:"_blank",rel:"noopener noreferrer"}},[e._v("Use Docker-in-Docker workflow with Docker executor"),t("OutboundLink")],1)])]),e._v(" "),t("h2",{attrs:{id:"gitlab-ci-yml-services"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gitlab-ci-yml-services"}},[e._v("#")]),e._v(" gitlab-ci.yml services")]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),t("ul",[t("li",[e._v("对services，image都是job的需要的容器。")]),e._v(" "),t("li",[e._v("既可以在所有job之外定义，也可以在job内定义service和image。")]),e._v(" "),t("li",[e._v("访问这些service或image的方式，就是通过他们的名字。\n把/换成-就是service的名字。")]),e._v(" "),t("li",[t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#passing-environment-variables-to-services",target:"_blank",rel:"noopener noreferrer"}},[e._v("可以传入service所需的环境变量。"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#available-settings-for-image",target:"_blank",rel:"noopener noreferrer"}},[e._v("image的设置"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#available-settings-for-services",target:"_blank",rel:"noopener noreferrer"}},[e._v("service的设置"),t("OutboundLink")],1)])])]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),t("ul",[t("li",[e._v("不仅gitlab-ci.yml中可以定义service或image。就连Runner的excutor都可以设置service和image。\n"),t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#define-image-and-services-in-configtoml",target:"_blank",rel:"noopener noreferrer"}},[e._v("Define image and services in config.toml"),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#define-image-and-services-from-gitlab-ciyml",target:"_blank",rel:"noopener noreferrer"}},[e._v("Define image and services from .gitlab-ci.yml"),t("OutboundLink")],1),e._v(" "),t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/services/",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitLab CI services examples"),t("OutboundLink")],1),e._v(" "),t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/services/postgres.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Using PostgreSQL"),t("OutboundLink")],1),e._v(" "),t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#how-services-are-linked-to-the-job",target:"_blank",rel:"noopener noreferrer"}},[e._v("How services are linked to the job"),t("OutboundLink")],1)]),e._v(" "),t("p",[t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#accessing-the-services",target:"_blank",rel:"noopener noreferrer"}},[e._v("Accessing the services"),t("OutboundLink")],1)]),e._v(" "),t("p",[t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#available-settings-for-services",target:"_blank",rel:"noopener noreferrer"}},[e._v("Available settings for services"),t("OutboundLink")],1)]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),t("p",[e._v("gitlab-ci 使用私有仓库的登陆方法：\n有两种。")]),e._v(" "),t("ul",[t("li",[e._v("在gitlab 变量中定义DOCKER_AUTH_CONFIG。就这个工程可以用。")]),e._v(" "),t("li",[e._v("在Runner中定义。DOCKER_AUTH_CONFIG 。只要注册了这个Runenr（Excutor）的所有工程都可以用。应用范围更广。")]),e._v(" "),t("li",[e._v("都是把 docker login之后生成的~/.docker/config.json 设置成DOCKER_AUTH_CONFIG变量。")])])]),e._v(" "),t("p",[t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#define-an-image-from-a-private-container-registry",target:"_blank",rel:"noopener noreferrer"}},[e._v("Define an image from a private Container Registry"),t("OutboundLink")],1),e._v("\n:::")]),e._v(" "),t("h2",{attrs:{id:"how-docker-integration-works"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#how-docker-integration-works"}},[e._v("#")]),e._v(" How Docker integration works")]),e._v(" "),t("h3",{attrs:{id:"整个gitlab-ci-runner是如何工作的。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#整个gitlab-ci-runner是如何工作的。"}},[e._v("#")]),e._v(" 整个gitlab-ci+ runner是如何工作的。")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_docker_images.html#how-docker-integration-works",target:"_blank",rel:"noopener noreferrer"}},[e._v("How Docker integration works"),t("OutboundLink")],1)]),e._v(" "),t("p",[e._v("看了"),t("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/docker/using_docker_build.html#use-docker-in-docker-workflow-with-docker-executor",target:"_blank",rel:"noopener noreferrer"}},[e._v("TLS enabled"),t("OutboundLink")],1),e._v(" 终于gitlab-ci中docker能跑起来了。")]),e._v(" "),t("h2",{attrs:{id:"gitlab-ci-yml中的image与runner上config-toml中的image有什么区别？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gitlab-ci-yml中的image与runner上config-toml中的image有什么区别？"}},[e._v("#")]),e._v(" gitlab-ci.yml中的image与runner上config.toml中的image有什么区别？")])])}),[],!1,null,null,null);r.default=o.exports}}]);