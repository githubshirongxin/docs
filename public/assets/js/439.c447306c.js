(window.webpackJsonp=window.webpackJsonp||[]).push([[439],{922:function(s,t,a){"use strict";a.r(t);var n=a(59),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"方法一：（开源命令一键生成）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方法一：（开源命令一键生成）"}},[s._v("#")]),s._v(" 方法一：（开源命令一键生成）")]),s._v(" "),a("p",[s._v("自签证书已经不用自己敲许多命令了。 直接用一个命令+域名就能生成所有证书。")]),s._v(" "),a("p",[s._v("https://github.com/Fishdrowned/ssl")]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("WARNING")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("注意必须是linux环境\n")])])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/Fishdrowned/ssl.git\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos3 ssl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd ssl")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos3 ssl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nca.cnf  docs  flush.sh  gen.cert.sh  gen.root.sh  LICENSE  README.md\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos3 ssl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./gen.cert.sh nexus.ccbjb.com.cn")]),s._v("\nRemoving "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v(" out\nCreating output structure\nstateOrProvinceName   :ASN.1 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Guangdong'")]),s._v("\nlocalityName          :ASN.1 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Guangzhou'")]),s._v("\norganizationName      :ASN.1 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Fishdrowned'")]),s._v("\norganizationalUnitName:ASN.1 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nexus.ccbjb.com.cn'")]),s._v("\ncommonName            :ASN.1 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*.nexus.ccbjb.com.cn'")]),s._v("\nCertificate is to be certified "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("until")]),s._v(" Aug  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 01:54:11 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v(" GMT "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("730")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nWrite out database with "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" new entries\nData Base Updated\n\nCertificates are located in:\nlrwxrwxrwx "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 09:54 /root/ssl/ssl/out/nexus.ccbjb.com.cn/nexus.ccbjb.com.cn.bundle.crt -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ./20200805-0954/nexus.ccbjb.com.cn .bundle.crt\nlrwxrwxrwx "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("38")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 09:54 /root/ssl/ssl/out/nexus.ccbjb.com.cn/nexus.ccbjb.com.cn.crt -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ./20200805-0954/nexus.ccbjb.com.cn.crt\nlrwxrwxrwx "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 09:54 /root/ssl/ssl/out/nexus.ccbjb.com.cn/nexus.ccbjb.com.cn.key.pem -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/cert.key.pem\nlrwxrwxrwx "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 09:54 /root/ssl/ssl/out/nexus.ccbjb.com.cn/root.crt -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/root.crt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos3 ssl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("h2",{attrs:{id:"方法二：-命令方法-，建立证书（我基本不用）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方法二：-命令方法-，建立证书（我基本不用）"}},[s._v("#")]),s._v(" 方法二： 命令方法 ，建立证书（我基本不用）")]),s._v(" "),a("h4",{attrs:{id:"建立自签名证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#建立自签名证书"}},[s._v("#")]),s._v(" 建立自签名证书")]),s._v(" "),a("h5",{attrs:{id:"_1-创建-private-key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建-private-key"}},[s._v("#")]),s._v(" 1. 创建 Private Key")]),s._v(" "),a("p",[s._v("sudo openssl genrsa -des3 -out /etc/gitlab/ssl/gitlab.domain.com.key 2048")]),s._v(" "),a("p",[s._v("记住输入的密码（Pass phrase）")]),s._v(" "),a("h5",{attrs:{id:"_2-生成-certificate-request"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-生成-certificate-request"}},[s._v("#")]),s._v(" 2. 生成 Certificate Request")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo openssl req -new -key /etc/gitlab/ssl/gitlab.domain.com.key -out /etc/gitlab/ssl/gitlab.domain.com.csr\n\nEnter Country Name US\nEnter State or Province Full Name\nEnter City Name\nEnter Organization Name\nEnter Company Name\nEnter Organizational Unit Name\nEnter server hostname i.e. URL gitlab.domain.com\nEnter Admin Email Address\nSkip Challenge Password (Hit Enter)\nSkip Optional Company Name (Hit Enter)\n#注: 第一步和第二部可以合并成一条命令\nopenssl req -nodes -newkey rsa:2048 -keyout gitlab.domain.com.key -out gitlab.domain.com.csr\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h4",{attrs:{id:"_3-移除private-key-中的密码短语"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-移除private-key-中的密码短语"}},[s._v("#")]),s._v(" 3. 移除Private Key 中的密码短语")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo cp -v /etc/gitlab/ssl/gitlab.domain.com.{key,original}\nsudo openssl rsa -in /etc/gitlab/ssl/gitlab.domain.com.original -out /etc/gitlab/ssl/gitlab.domain.com.key\nsudo rm -v /etc/gitlab/ssl/gitlab.domain.com.original\n#4. 创建证书\nsudo openssl x509 -req -days 1460 -in /etc/gitlab/ssl/gitlab.domain.com.csr -signkey /etc/gitlab/ssl/gitlab.domain.com.key -out /etc/gitlab/ssl/gitlab.domain.com.crt\n#5. 移除证书请求文件\nsudo rm -v /etc/gitlab/ssl/gitlab.domain.com.csr    \n// 设置文件权限\nsudo chmod 600 /etc/gitlab/ssl/gitlab.domain.com.*\n#gitlab 配置更改\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);