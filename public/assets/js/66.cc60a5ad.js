(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{541:function(e,s,a){"use strict";a.r(s);var n=a(55),t=Object(n.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("注意:需要在本地安装vuepress，否则PWA功能实现不了")]),e._v(" "),a("h2",{attrs:{id:"_7-pwa离线功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-pwa离线功能"}},[e._v("#")]),e._v(" 7 PWA离线功能")]),e._v(" "),a("p",[e._v("vuepress指南→插件→"),a("a",{attrs:{href:"https://www.vuepress.cn/plugin/official/plugin-pwa.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("pws"),a("OutboundLink")],1),e._v(" "),a("code",[e._v("npm install -D @vuepress/plugin-pwa")])]),e._v(" "),a("p",[e._v("config.js的分配置pluginConf.js")]),e._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'@vuepress/pwa'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      serviceWorker"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      updatePopup"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'/'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n          message"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"New content is available."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n          buttonText"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Refresh"')]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'/zh/'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n          message"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"发现新内容可用"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n          buttonText"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"刷新"')]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),a("p",[e._v("为了让你的网站完全地兼容 PWA，你需要:\n在 .vuepress/public 提供 Manifest 和 icons\n在 .vuepress/config.js 添加正確的 head links(参见下面例子).\n更多细节，请参见 "),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/Manifest",target:"_blank",rel:"noopener noreferrer"}},[e._v("MDN docs about the Web App Manifest"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[a("img",{attrs:{src:"/docs/images/2020-07-23-08-03-55.png",alt:""}})]),e._v(" "),a("h3",{attrs:{id:"从vuepress包里拿manifest-json放到pulic下过来改改。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从vuepress包里拿manifest-json放到pulic下过来改改。"}},[e._v("#")]),e._v(" 从vuepress包里拿manifest.json放到pulic下过来改改。")]),e._v(" "),a("ul",[a("li",[e._v("改改name，shortname")]),e._v(" "),a("li",[e._v("改改图片的位置增加"),a("code",[e._v("/vuepress/")]),e._v("(config.js里的base=vuepress对manifest不起作用，必须的自己改。)\n否则，浏览器有错误。\n如果是docs库，那么就需要改成"),a("code",[e._v("/docs/icons/xxx")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n  "name": "cjb的资料库",\n  "short_name": "cjb",\n  "icons": [\n    {\n      "src": "/vuepress/icons/android-chrome-192x192.png",\n      "sizes": "192x192",\n      "type": "image/png"\n    },\n    {\n      "src": "/vuepress/icons/android-chrome-512x512.png",\n      "sizes": "512x512",\n      "type": "image/png"\n    }\n  ],\n  "start_url": "/vuepress/index.html",\n  "display": "standalone",\n  "background_color": "#fff",\n  "theme_color": "#3eaf7c"\n}\n')])])]),a("h3",{attrs:{id:"从vuepress包里拿icons整个目录放到public下"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从vuepress包里拿icons整个目录放到public下"}},[e._v("#")]),e._v(" 从vuepress包里拿icons整个目录放到public下")]),e._v(" "),a("p",[a("img",{attrs:{src:"/docs/images/2020-07-23-08-16-57.png",alt:""}})]),e._v(" "),a("h3",{attrs:{id:"headconf-js例子里拷贝过来就行。和上面的icons是能对应上"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#headconf-js例子里拷贝过来就行。和上面的icons是能对应上"}},[e._v("#")]),e._v(" headConf.js例子里拷贝过来就行。和上面的icons是能对应上")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("head: [\n    ['link', { rel: 'icon', href: '/logo.png' }],\n    ['link', { rel: 'manifest', href: '/manifest.json' }],\n    ['meta', { name: 'theme-color', content: '#3eaf7c' }],\n    ['meta', { name: 'apple-mobile-web-app-capable', content: 'yes' }],\n    ['meta', { name: 'apple-mobile-web-app-status-bar-style', content: 'black' }],\n    ['link', { rel: 'apple-touch-icon', href: '/icons/apple-touch-icon-152x152.png' }],\n    ['link', { rel: 'mask-icon', href: '/icons/safari-pinned-tab.svg', color: '#3eaf7c' }],\n    ['meta', { name: 'msapplication-TileImage', content: '/icons/msapplication-icon-144x144.png' }],\n    ['meta', { name: 'msapplication-TileColor', content: '#000000' }]\n  ],\n")])])]),a("p",[e._v("后话：\n在所有章节都设置完了之后发现加上PWA\n这个之后有时候比更新，更新比较慢，甚至有的md文件就不显示。\n为了调试方便，暂时把headerConf.js中PWA相关的注释掉，push之后马上能看到结果。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("    // SEO\n    ['meta', { name: 'name', content: 'cjb的资料库' }],\n    ['meta', { name: 'keywords', content: 'java,cobol,分布式存储' }], // 增加一个自定义的 favicon(网页标签的图标)\n    ['link', { rel: 'icon', href: '/logo.png' }],\n    // PWA\n    // ['link', { rel: 'icon', href: '/logo.png' }],\n    // ['link', { rel: 'manifest', href: '/manifest.json' }],\n    // ['meta', { name: 'theme-color', content: '#3eaf7c' }],\n    // ['meta', { name: 'apple-mobile-web-app-capable', content: 'yes' }],\n    // ['meta', { name: 'apple-mobile-web-app-status-bar-style', content: 'black' }],\n    // ['link', { rel: 'apple-touch-icon', href: '/icons/apple-touch-icon-152x152.png' }],\n    // ['link', { rel: 'mask-icon', href: '/icons/safari-pinned-tab.svg', color: '#3eaf7c' }],\n    // ['meta', { name: 'msapplication-TileImage', content: '/icons/msapplication-icon-144x144.png' }],\n    // ['meta', { name: 'msapplication-TileColor', content: '#000000' }]\n")])])]),a("p",[e._v("pluginConf.js")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('  //为了测试方便，暂时把PWA功能注释了。\n  // \'@vuepress/pwa\': {\n  //   serviceWorker: true,\n  //   updatePopup: {\n  //     \'/\': {\n  //       message: "New content is available.",\n  //       buttonText: "Refresh"\n  //     },\n  //     \'/zh/\': {\n  //       message: "发现新内容可用",  \n  //       buttonText: "刷新"\n  //     }\n  //   }\n  // },\n')])])]),a("p",[e._v("想启动PWA的话，删除这两个文件的注释。重新编译。"),a("code",[e._v("npm run build")])]),e._v(" "),a("h2",{attrs:{id:"编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译"}},[e._v("#")]),e._v(" 编译")]),e._v(" "),a("p",[a("code",[e._v("npm run build")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('tip Apply plugin @vuepress/pwa (i.e. "@vuepress/plugin-pwa") ...\n\n√ Client\n  Compiled successfully in 9.57s\n\n√ Server\n  Compiled successfully in 7.88s\n\nwait Rendering static HTML...\nwait Generating service worker...\nsuccess Generated static files in docs\\.vuepress\\dist.\n')])])]),a("h3",{attrs:{id:"编译将会生成dist-service-worker-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译将会生成dist-service-worker-js"}},[e._v("#")]),e._v(" 编译将会生成dist/service-worker.js")]),e._v(" "),a("p",[a("img",{attrs:{src:"/docs/images/2020-07-23-08-28-13.png",alt:""}})]),e._v(" "),a("p",[a("code",[e._v("npm run deploy")])]),e._v(" "),a("h2",{attrs:{id:"都配置完成之后怎么测试呢？"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#都配置完成之后怎么测试呢？"}},[e._v("#")]),e._v(" 都配置完成之后怎么测试呢？")]),e._v(" "),a("p",[e._v("必须在本地安装vuepress，否则无法生成servic-worker.js\n"),a("img",{attrs:{src:"/docs/images/2020-07-23-08-47-35.png",alt:""}}),e._v("\n在浏览器F11，看到Cache里存储了这些。就OK了。说明断网也可以浏览这些存储过的东西了。")]),e._v(" "),a("h3",{attrs:{id:"浏览器没error"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器没error"}},[e._v("#")]),e._v(" 浏览器没error")]),e._v(" "),a("p",[e._v("之前浏览过的网页断网也能看")]),e._v(" "),a("h3",{attrs:{id:"手机端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手机端"}},[e._v("#")]),e._v(" 手机端")]),e._v(" "),a("p",[e._v("打开网页，提示你添加到主屏。然后浏览一通。断网。再浏览，发现都缓存下来了。不怕断网。仍旧能看一段时间！！")])])}),[],!1,null,null,null);s.default=t.exports}}]);